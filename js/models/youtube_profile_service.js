define(["underscore","backbone","safe"],function(e,t){var n=t.Model.extend({safe:{key:"Echoes-YoutubeProfileService",options:{reload:!1}},cred:{clientId:"971861197531.apps.googleusercontent.com",clientSecret:"t7KrdesISXI-4ViBJ5jZOXSt",token:""},signinUrl:function(){return["https://accounts.google.com/o/oauth2/auth?","client_id="+this.cred.clientId+"&","redirect_uri=http://echotu.be/&","scope=https://gdata.youtube.com&","response_type=token"].join("")},refreshToken:function(){return["https://accounts.google.com/o/oauth2/token?","client_id="+this.cred.clientId+"&","client_secret="+this.cred.clientSecret+"&","refresh_token="+this.get("token")+"&","grant_type=refresh_token"].join("")},profile:function(){return"https://gdata.youtube.com/feeds/api/users/default?access_token="+this.get("token")+"&alt=json&v=2"},signin:function(){return this.signinUrl()},initialize:function(){this.on("change:token",this.fetchProfile,this),this.on("change:author",this.onProfileChange,this),this.safe.reload()},fetchProfile:function(e,t){this.cred.token=t,this.url=this.profile(),this.fetch()},setToken:function(e){this.set("token",e)},parse:function(e){e&&this.set(e.entry)},getUsername:function(){return this.get("yt$username")?this.get("yt$username").$t:""},getDisplayUsername:function(){return this.get("yt$username")?this.get("yt$username").display:"Username"},getThumbnail:function(){return this.get("media$thumbnail")?this.get("media$thumbnail").url:""}});return n})